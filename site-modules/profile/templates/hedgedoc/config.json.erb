{
    "<%= @runtime_environment %>": {
        "sessionSecret": "<%= @session_secret %>",
        "allowAnonymous": <%= @allow_anonymous %>,
        "allowAnonymousEdit": <%= @allow_anonymous_edits %>,
        "allowFreeURL": true,
        "protocolUseSSL": true,
        "domain": "<%= @base_url %>",
        "loglevel": "<%= @log_level %>",
        "allowOrigin": [ "localhost", "<%= @base_url %>"],
        "email": <%= @allow_email %>,
        "allowEmailRegister": <%= @allow_email_register %>,
<% if @enable_keycloak -%>
        "oauth2": {
            "providerName": "<%= @keycloak_provider_name %>",
            "baseURL": "https://<%= @keycloak_domain %>/",
            "userProfileURL": "https://<%= @keycloak_domain %>/auth/realms/<%= @keycloak_realm %>/protocol/openid-connect/userinfo",
            "userProfileUsernameAttr": "preferred_username",
            "userProfileDisplayNameAttr": "name",
            "userProfileEmailAttr": "email",
            "tokenURL": "https://<%= @keycloak_domain %>/auth/realms/<%= @keycloak_realm %>/protocol/openid-connect/token",
            "authorizationURL": "https://<%= @keycloak_domain %>/auth/realms/<%= @keycloak_realm %>/protocol/openid-connect/auth",
            "clientID": "<%= @keycloak_client_id %>",
            "clientSecret": "<%= @keycloak_client_secret %>"
        },
<% end -%>
        "hsts": {
            "enable": true,
            "maxAgeSeconds": 31536000,
            "includeSubdomains": true,
            "preload": true
        },
        "csp": {
            "enable": true,
            "upgradeInsecureRequests": "auto",
            "addDefaults": true,
            "addDisqus": true,
            "addGoogleAnalytics": true
        },
        "cookiePolicy": "lax",
        "db": {
            "username": "<%= @db_user %>",
            "password": "<%= @db_password %>",
            "database": "<%= @db_name %>",
            "host": "<%= @db_host %>",
            "port": "<%= @db_port %>",
            "dialect": "postgres"
        },
        "linkifyHeaderStyle": "gfm"
    }
}
