dar::backup::exclude:
  - srv/softwareheritage/annex

# Deploy the storage server as a public resource
swh::deploy::storage::backend::listen::host: 0.0.0.0
swh::deploy::storage::backend::workers: 96
swh::deploy::storage::config:
  storage:
    cls: local
    args:
      db: "host=%{hiera('swh::deploy::storage::db::host')} user=%{hiera('swh::deploy::storage::db::user')} dbname=%{hiera('swh::deploy::storage::db::dbname')} password=%{hiera('swh::deploy::storage::db::password')}"
      objstorage:
        cls: multiplexer
        args:
          storages:
            - cls: pathslicing
              args:
                root: "%{hiera('swh::deploy::storage::directory')}"
                slicing: "0:2/2:4/4:6"
            - "%{alias('swh::remote_service::objstorage::config::azure')}"

# Deploy the indexer storage server as a public resource
swh::deploy::indexer::storage::backend::listen::host: 0.0.0.0
swh::deploy::indexer::storage::backend::workers: 32
swh::deploy::indexer::storage::config:
  indexer_storage:
    cls: local
    args:
      db: "host=%{hiera('swh::deploy::indexer::storage::db::host')} port=%{hiera('swh::deploy::indexer::storage::db::port')} user=%{hiera('swh::deploy::indexer::storage::db::user')} dbname=%{hiera('swh::deploy::indexer::storage::db::dbname')} password=%{hiera('swh::deploy::indexer::storage::db::password')}"

# open objstorage api
swh::deploy::objstorage::backend::listen::host: 0.0.0.0
swh::deploy::objstorage::backend::workers: 16

swh::deploy::worker::instances:
  - swh_storage_archiver

icinga2::host::vars:
  load: high
  disks:
    disk /srv/storage/0:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/1:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/2:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/3:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/4:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/5:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/6:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/7:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/8:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/9:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/a:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/b:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/c:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/d:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/e:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/f:
      disk_wfree: '5%'
      disk_cfree: '3%'
    disk /srv/storage/space/mirrors/gitorious.org/mnt:
      disk_wfree: '5%'
      disk_cfree: '3%'
